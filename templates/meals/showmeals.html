{% extends "base.html" %}
{% load static %}
{% block css_style %}
.resultTbl {
    width: 90%;
    max-width: 1100px;
    display: flex;
    flex-flow: row wrap;
    justify-content: space-evenly;
    align-content: space-around;
}


.recCard {
    width: 250px;
    border: 1px solid #000;
    border-radius 5px 5px;
    background-color: #fffffe;
    margin: 10px 0px 10px 0px;
    padding: 30px 10px 0px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
}

th{
    font-size: 20px; 
    font-family: 'Zilla Slab', serif;
    color: #16a32e;
}

td{
    text-align: center;
    font-family: 'Be Vietnam Pro', sans-serif;
    font-weight: 300;
    font-size: 14px;
}

.leftTd{
    text-align: right;
    font-weight: bold;
}

.rightTd{
    text-align: left;
}

{% endblock css_style %}

{% block page_content %}

{% if plan_view %}
<h1>Recipes in: {{ mp.name }}</h1>
{% elif add_to_plan_view %}
<h1>Browsing Recipes for: {{ mp.name }}</h1> 
{% else %}
<h1>Browse Recipes</h1>
{% endif %}

<h3><a href="{% url 'get-recipe' %}">Submit Recipes</a></h3>

{% if add_to_plan_view %}
<div>
    <form action="{% url 'add_to_plan' mp.id %}">
    <select name="meal_time">
        <option value="%">-- Select a Meal Time --</option>
        {% for key, value in meal_time %}
        <option value="{{ key }}">{{ value }}</option>    
        {% endfor %}
    </select>

    <Select name="cooking_time">
        <option value="%">-- Select a Cooking Time --</option>
        {% for key, value in cooking_time %}
        <option value="{{ key }}">{{ value }}</option>    
        {% endfor %}
    </Select>

    <Select name="cooking_method">
        <option value="%">-- Select a Cooking Method --</option>
        {% for key, value in cooking_method %}
        <option value="{{ key }}">{{ value }}</option>    
        {% endfor %}
    </Select>

    <Select name="dish_type">
        <option value="%">-- Select a Dish Type --</option>
        {% for key, value in dish_type %}
        <option value="{{ key }}">{{ value }}</option>    
        {% endfor %}
    </Select>
<input type="submit" value="Search">
</form>
</div>
{% endif %}
<hr/>


<div class="resultTbl">
    {% for meal in meals %}
        <div class=recCard>
            <table>
                <th colspan=2>{% if plan_view %}{{ meal.meal__title }}{% else %}{{ meal.title }}{% endif %}</th>
                {% if plan_view %}
                <tr><td>{% if meal.review == 1 %}
                <img src="{% static 'images/thumbs-up-selected.svg' %}" alt="Selected Thumbs Up Rating" title="You have selected a thumbs up rating for this recipe">
                        {% else %}
                <a href="{% url 'view-plan-vote' plan_id=mp.id review=1 meal_id=meal.meal_id %}" ><img src="{% static 'images/thumbs-up.svg' %}" alt="Thumbs Up Rating" title="Click to select a thumbs up rating for this recipe"></a>
                        {% endif %} 
                </td><td>
                        {% if meal.review == -1 %}
                <img src="{% static 'images/thumbs-down-selected.svg' %}" alt="Selected Thumbs Down Rating" title="You have selected a thumbs down rating for this recipe">
                        {% else %}
                <a href="{% url 'view-plan-vote' plan_id=mp.id review=2 meal_id=meal.meal_id %}"><img src="{% static 'images/thumbs-down.svg' %}" alt="Thumbs Down Rating" title="Click to select a thumbs down rating for this recipe"></a> 
                        {% endif %}
                </td></tr>
                {% endif %}    
            <tr><td><b>Vegan:</b> {% if plan_view %}{{ meal.meal__vegan|yesno:"Yes,No" }}{% else %}{{ meal.vegan|yesno:"Yes,No" }}{% endif %}</td><td><b>Vegetarian:</b> {% if plan_view %}{{ meal.meal__vegetarian|yesno:"Yes,No" }}{% else %}{{ meal.vegetarian|yesno:"Yes,No" }}{% endif %}</td></tr>
            <tr><td class="leftTd">Meal Time:</td>
                <td class="rightTd">
                {% if plan_view %}    
                    {% if meal.meal__meal_time == 'bk' %}  Breakfast
                    {% elif meal.meal__meal_time == 'lu' %}  Lunch 
                    {% elif meal.meal__meal_time == 'di' %}  Dinner 
                    {% elif meal.meal__meal_time == 'de' %}  Dessert
                    {% elif meal.meal__meal_time == 'sn' %}  Snack         
                    {% endif %}
                {% else %}
                {{ meal.get_meal_time_display }}
                {% endif %}
            </td></tr>
            <tr><td class="leftTd">Cooking Time:</td>
                <td class="rightTd">
                {% if plan_view %}
                    {% if meal.meal__cooking_time == '20' %}  Less than 20 Minutes
                    {% elif meal.meal__cooking_time == '40' %}  20 to 40 Minutes
                    {% elif meal.meal__cooking_time == '60' %}  40 to 60 Minutes
                    {% elif meal.meal__cooking_time == '61' %}  Over 60 Minutes
                    {% endif %}
                {% else %}
                {{ meal.get_cooking_time_display }}
                {% endif %}
            </td></tr>
            <tr><td class="leftTd">Method:</td>
                <td class="rightTd">
                {% if plan_view %}
                    {% if meal.meal__cooking_method == 'st' %}  Stovetop
                    {% elif meal.meal__cooking_method == 'mi' %}  Microwave 
                    {% elif meal.meal__cooking_method == 'bl' %}  Blender 
                    {% elif meal.meal__cooking_method == 'gr' %}  Grill 
                    {% elif meal.meal__cooking_method == 'ov' %}  Oven 
                    {% elif meal.meal__cooking_method == 'pr' %}  Pressure Cooker 
                    {% elif meal.meal__cooking_method == 'sc' %}  Slow Cooker 
                    {% elif meal.meal__cooking_method == 'af' %}  Air Fryer 
                    {% endif %}
                {% else %}
                {{ meal.get_cooking_method_display }}
                {% endif %}
            </td></tr>
            <tr><td class="leftTd">Dish Type:</td>
                <td class="rightTd">
                {% if plan_view %}
                    {% if meal.meal__dish_type == 'sp' %}  Soup
                    {% elif meal.meal__dish_type == 'bk' %}  Baked Dish
                    {% elif meal.meal__dish_type == 'pa' %}  Pasta
                    {% elif meal.meal__dish_type == 'cu' %}  Curry 
                    {% elif meal.meal__dish_type == 'ca' %}  Cassarole
                    {% elif meal.meal__dish_type == 'st' %}  Stew
                    {% elif meal.meal__dish_type == 'sa' %}  Salad
                    {% elif meal.meal__dish_type == 'lt' %}  Light Dish
                    {% elif meal.meal__dish_type == 'sm' %}  Smoothie 
                    {% elif meal.meal__dish_type == 'na' %}  Other
                    {% endif %}
                {% else %}
                {{ meal.get_dish_type_display }}
                {% endif %}
                </td></tr>
            <tr><td><a href="{% if plan_vew %}{{ meal.meal__rec_url }}{% else %}{{ meal.rec_url }}{% endif %}", target="_blank"><img src="{% static 'images/book-open.svg' %}" alt="Open Book" title="Open Recipe in New Tab"></a></td>
                <td>
                {% if plan_view %}
                <a href="{% url 'del_meal_from_plan' mp.id meal.meal_id %}"><img src="{% static 'images/trash-2.svg' %}" alt="Trash Can" title="Remove from Meal Plan"></a>
                {% elif add_to_plan_view %}
                <a href="{% url 'add_meal_to_plan' mp.id meal.meal_id %}"><img src="{% static 'images/file-plus.svg' %}" alt="File with add sign" tite="Add Recipe to Meal Plan"></a>
                {% endif %}
                </td></tr>
            </table>
            <br>
            <br>
        </div>
    {% endfor %}
</div>
{% if plan_view %}
<h3><a href="{% url 'add_to_plan' mp.id %}">Add More Recipes to Plan</a></h3>
<br>
<h4><a href="{% url 'del_plan' mp.id %}">Delete this Plan</a></h4>
{% elif add_to_plan_view%}
<h3><a href="{% url 'view-plan' mp.id %}">Back to {{ mp.name }} Overview</a></h3>
{% endif %}
<br>
<h4><a href="{% url 'welcome' %}">Account Home</a></h4>
{% endblock page_content %}